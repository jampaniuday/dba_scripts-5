select 'ALTER INDEX '||owner||'.'||index_name||' REBUILD ONLINE;' FROM  DBA_INDEXES where 
table_name in ('PPCS_CONSALDO','PPCS_MECOORIG','PPCS_LLAMADAS','PPCS_MULSALDET','PPCS_EVENTPROM','PPCS_CONTENT','PPCS_MECOTERM','PPCS_DIAMETER','PPCS_DESVIOS','PPCS_ROAMT','PPCS_ROAMO','PPCS_ROAMD')
AND INDEX_TYPE <> 'LOB' and tablespace_name is not null;

SELECT 'ALTER INDEX '||B.owner||'.'||A.INDEX_NAME||' REBUILD PARTITION '||A.PARTITION_NAME ||'  ONLINE;'
FROM DBA_IND_PARTITIONS A , DBA_INDEXES B
WHERE A.INDEX_NAME= B.INDEX_NAME  AND
A.INDEX_OWNER = B.OWNER AND
(a.partition_name like '%_131231' or a.partition_name like '%_1312') and
B.TABLE_NAME in ('PPCS_CONSALDO','PPCS_MECOORIG','PPCS_LLAMADAS','PPCS_MULSALDET','PPCS_EVENTPROM','PPCS_CONTENT','PPCS_MECOTERM','PPCS_DIAMETER','PPCS_DESVIOS','PPCS_ROAMT','PPCS_ROAMO','PPCS_ROAMD')
AND B.INDEX_TYPE <> 'LOB'


Select * from dba_indexes where status <> 'VALID' and owner = 'PPCS';

select * from dba_ind_partitions where status <> 'USABLE' and index_owner = 'PPCS';



ALTER INDEX PPCS.PK_ROAMD REBUILD ONLINE;
ALTER INDEX PPCS.PK_ROAMO REBUILD ONLINE;
ALTER INDEX PPCS.PK_ROAMT REBUILD ONLINE;

ALTER INDEX PPCS.PK_CONTENT REBUILD PARTITION CONTENT_140101  ONLINE;
ALTER INDEX PPCS.PK_DESVIOS REBUILD PARTITION DESVIOS_1401  ONLINE;
ALTER INDEX PPCS.PK_DIAMETER REBUILD PARTITION DIAMETER_140101  ONLINE;
ALTER INDEX PPCS.PPCS_DIAMETER_I01 REBUILD PARTITION DIAMETER_140101  ONLINE;
ALTER INDEX PPCS.PK_MECOORIG REBUILD PARTITION MECOORIG_140101  ONLINE;
ALTER INDEX PPCS.PK_MECOTERM REBUILD PARTITION MECOTERM_140101  ONLINE;
ALTER INDEX PPCS.PK_EVENTPROM REBUILD PARTITION EVENTPROM_140101  ONLINE;
ALTER INDEX PPCS.PK_CONSALDO REBUILD PARTITION CONSALDO_140101  ONLINE;
ALTER INDEX PPCS.PK_MULSALDET REBUILD PARTITION MULSALDET_140101  ONLINE;
ALTER INDEX PPCS.PPCS_MULSALDET_011_I01 REBUILD PARTITION MULSALDET_140101  ONLINE;
ALTER INDEX PPCS.PK_LLAMADAS REBUILD PARTITION LLAMADAS_140101  ONLINE;


ALTER INDEX PPCS.PK_CONTENT REBUILD PARTITION CONTENT_131231  ONLINE;
ALTER INDEX PPCS.PK_DESVIOS REBUILD PARTITION DESVIOS_1312  ONLINE;
ALTER INDEX PPCS.PK_DIAMETER REBUILD PARTITION DIAMETER_131231  ONLINE;
ALTER INDEX PPCS.PPCS_DIAMETER_I01 REBUILD PARTITION DIAMETER_131231  ONLINE;
ALTER INDEX PPCS.PK_MECOORIG REBUILD PARTITION MECOORIG_131231  ONLINE;
ALTER INDEX PPCS.PK_MECOTERM REBUILD PARTITION MECOTERM_131231  ONLINE;
ALTER INDEX PPCS.PK_EVENTPROM REBUILD PARTITION EVENTPROM_131231  ONLINE;
ALTER INDEX PPCS.PK_CONSALDO REBUILD PARTITION CONSALDO_131231  ONLINE;
ALTER INDEX PPCS.PK_MULSALDET REBUILD PARTITION MULSALDET_131231  ONLINE;
ALTER INDEX PPCS.PPCS_MULSALDET_011_I01 REBUILD PARTITION MULSALDET_131231  ONLINE;
ALTER INDEX PPCS.PK_LLAMADAS REBUILD PARTITION LLAMADAS_131231  ONLINE;


truncate table ppcs.ppcs_detalle_mov;

execute PPCS.SP_DETALLE_MOV;

alter session set nls_date_format='dd-mm-yyyy hh24:mi:ss';


col texto format a50
select * from PPCS.PPCS_DETALLE_MOV;