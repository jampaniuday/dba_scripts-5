el usuario debe tener el privilegio de systema

grant CREATE METERIALIZED VIEW to SMSB03_0300_NI_SCH

un ejemplo

CREATE MATERIALIZED VIEW sales_by_month_by_state
     TABLESPACE example
     PARALLEL 4
     BUILD IMMEDIATE
     REFRESH COMPLETE
     ENABLE QUERY REWRITE
     AS SELECT t.calendar_month_desc, c.cust_state_province,
        SUM(s.amount_sold) AS sum_sales
        FROM times t, sales s, customers c
        WHERE s.time_id = t.time_id AND s.cust_id = c.cust_id
        GROUP BY t.calendar_month_desc, c.cust_state_province;


El tiempo de refrescamiento

REFRESH FAST START WITH SYSDATE NEXT  SYSDATE + 1/4096 
REFRESH FAST NEXT sysdate + 7


   REFRESH START WITH ROUND(SYSDATE + 1) + 11/24 
   NEXT NEXT_DAY(TRUNC(SYSDATE), 'MONDAY') + 15/24 



-----------------------------------------


-- CDR
SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM SMSB03_0300_NI_SCH.SMB_CDR A, SMSB03_0300_NI_SCH.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1


-- Mensaje Campaña
SELECT A.*, B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER 
FROM   SMSB03_0300_NI_SCH.SMB_STATS_BY_PERIOD_REPORTS_V A, SMSB03_0300_NI_SCH.SMB_MESSAGE B, SMSB03_0300_NI_SCH.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1


MEDIUM_TABLES


SMSB03_0300_NI_SCH
SMSB03_0300_SV_SCH
SMSB03_0300_CR_SCH
SMSB03_0300_GT_SCH
SMSB03_0300_PA_SCH


------


grant CREATE MATERIALIZED VIEW to SMSB03_0300_NI_SCH;
grant CREATE MATERIALIZED VIEW to SMSB03_0300_SV_SCH;
grant CREATE MATERIALIZED VIEW to SMSB03_0300_CR_SCH;
grant CREATE MATERIALIZED VIEW to SMSB03_0300_GT_SCH;
grant CREATE MATERIALIZED VIEW to SMSB03_0300_PA_SCH;

--------------------------------------------

CREATE MATERIALIZED VIEW SMSB03_0300_NI_SCH.CDR_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM SMSB03_0300_NI_SCH.SMB_CDR A, SMSB03_0300_NI_SCH.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


CREATE MATERIALIZED VIEW SMSB03_0300_NI_SCH.MENSAJE_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   SMSB03_0300_NI_SCH.SMB_STATS_BY_PERIOD_REPORTS_V A, SMSB03_0300_NI_SCH.SMB_MESSAGE B, SMSB03_0300_NI_SCH.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;
--------------------

CREATE MATERIALIZED VIEW SMSB03_0300_SV_SCH.CDR_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM SMSB03_0300_SV_SCH.SMB_CDR A, SMSB03_0300_SV_SCH.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


CREATE MATERIALIZED VIEW SMSB03_0300_SV_SCH.MENSAJE_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   SMSB03_0300_SV_SCH.SMB_STATS_BY_PERIOD_REPORTS_V A, SMSB03_0300_SV_SCH.SMB_MESSAGE B, SMSB03_0300_SV_SCH.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;

--------------------------------


CREATE MATERIALIZED VIEW SMSB03_0300_CR_SCH.CDR_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM SMSB03_0300_CR_SCH.SMB_CDR A, SMSB03_0300_CR_SCH.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


CREATE MATERIALIZED VIEW SMSB03_0300_CR_SCH.MENSAJE_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   SMSB03_0300_CR_SCH.SMB_STATS_BY_PERIOD_REPORTS_V A, SMSB03_0300_CR_SCH.SMB_MESSAGE B, SMSB03_0300_CR_SCH.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;

----------------------------------------------------


CREATE MATERIALIZED VIEW SMSB03_0300_GT_SCH.CDR_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM SMSB03_0300_GT_SCH.SMB_CDR A, SMSB03_0300_GT_SCH.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


CREATE MATERIALIZED VIEW SMSB03_0300_GT_SCH.MENSAJE_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   SMSB03_0300_GT_SCH.SMB_STATS_BY_PERIOD_REPORTS_V A, SMSB03_0300_GT_SCH.SMB_MESSAGE B, SMSB03_0300_GT_SCH.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;


----------------------------

CREATE MATERIALIZED VIEW SMSB03_0300_PA_SCH.CDR_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM SMSB03_0300_PA_SCH.SMB_CDR A, SMSB03_0300_PA_SCH.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


CREATE MATERIALIZED VIEW SMSB03_0300_PA_SCH.MENSAJE_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   SMSB03_0300_PA_SCH.SMB_STATS_BY_PERIOD_REPORTS_V A, SMSB03_0300_PA_SCH.SMB_MESSAGE B, SMSB03_0300_PA_SCH.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;







----------------------------- MOP -----------------------------------------

-- CDR
SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM <USUARIO_PAIS>.SMB_CDR A, <USUARIO_PAIS>.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


-- Mensaje Campaña
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   <USUARIO_PAIS>.SMB_STATS_BY_PERIOD_REPORTS_V A, <USUARIO_PAIS>.SMB_MESSAGE B, <USUARIO_PAIS>.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;

----------------------------- VISTA -----------------------------------------

CREATE MATERIALIZED VIEW <USUARIO_PAIS>.CDR_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS SELECT A.cdr_msg_cmp_id, A.cdr_cmp_name, A.CDR_PLATFORM_DATE, A.cdr_destination_number, 
B.PNS_FINAL_STATUS_CODE
FROM <USUARIO_PAIS>.SMB_CDR A, <USUARIO_PAIS>.SMB_PLATFORM_NETWORK_STATUS B
where   A.cdr_NES_status_ID = B.PNS_NES_STATUS_ID 
and A.CDR_PLATFORM_DATE > sysdate -1;


CREATE MATERIALIZED VIEW <USUARIO_PAIS>.MENSAJE_DIA
     TABLESPACE MEDIUM_TABLES
     BUILD IMMEDIATE
     REFRESH NEXT trunc(sysdate) + 1
AS
SELECT
A.STA_SNAPSHOOT_TIME,A.SNAPSHOT_TO_TIME,A.STA_CMP_ID,A.STA_CMP_STATE,A.STA_CMP_EXECUTED_TIME,A.STA_TOTAL_MSG_TO_SEND,A.STA_TOTAL_TRIES,A.STA_TOTAL_RETRIES,A.STA_TOTAL_MSG_RETRIED,
A.STA_MSG_Y_DELIVERED,A.STA_MSG_Y_DELIVERED_1_RETRY,A.STA_MSG_Y_DELIVERED_2_RETRY,A.STA_MSG_Y_DELIVERED_3_RETRY,A.STA_MSG_Y_DELIVERED_4_RETRY,A.STA_MSG_Y_DELIVERED_5_RETRY,
A.STA_MSG_Y_DELIVERED_6_RETRY,A.STA_MSG_Y_DELIVERED_7_RETRY,A.STA_MSG_Y_DELIVERED_8_RETRY,A.STA_MSG_Y_DELIVERED_9_RETRY,A.STA_MSG_Y_DELIVERED_10_RETRY,A.STA_MSG_Y_DELIVERED_0_RETRY,
A.STA_MSG_P_FAILED,A.STA_MSG_N_RETRY_EXCEEDED,A.STA_MSG_V_EXPIRED,A.STA_MSG_U_NOT_PROCESSED,A.STA_MSG_W_NOT_YET_TRIED,A.STA_MSG_I_OPERATION_ERROR,A.STA_MSG_O_OTHER_COMPANY,
A.STA_MSG_E_NEVER_TRIED,A.STA_MSG_B_BLOCKED_BY_FILTER,
B.MSG_SUBJECT, B.MSG_TEXT, C.CMP_ORIGIN_NUMBER
FROM   <USUARIO_PAIS>.SMB_STATS_BY_PERIOD_REPORTS_V A, <USUARIO_PAIS>.SMB_MESSAGE B, <USUARIO_PAIS>.SMB_CAMPAIGN C
WHERE  A.STA_CMP_ID = B.MSG_CMP_ID AND
    A.STA_CMP_ID = C.CMP_ID AND
    A.STA_CMP_STATE = 'FINISHING' 
    AND     A.SNAPSHOT_TO_TIME IS NULL
and A.STA_SNAPSHOOT_TIME > SYSDATE -1;


DROP MATERIALIZED VIEW <USUARIO_PAIS>.MENSAJE_DIA
DROP MATERIALIZED VIEW <USUARIO_PAIS>.CDR_DIA
-----------------------------------------------

SMSB03_0300_NI_SCH
SMSB03_0300_SV_SCH
SMSB03_0300_CR_SCH
SMSB03_0300_GT_SCH
SMSB03_0300_PA_SCH


DROP MATERIALIZED VIEW SMSB03_0300_NI_SCH.MENSAJE_DIA
DROP MATERIALIZED VIEW SMSB03_0300_NI_SCH.CDR_DIA

DROP MATERIALIZED VIEW SMSB03_0300_SV_SCH.MENSAJE_DIA
DROP MATERIALIZED VIEW SMSB03_0300_SV_SCH.CDR_DIA

DROP MATERIALIZED VIEW SMSB03_0300_CR_SCH.MENSAJE_DIA
DROP MATERIALIZED VIEW SMSB03_0300_CR_SCH.CDR_DIA

DROP MATERIALIZED VIEW SMSB03_0300_GT_SCH.MENSAJE_DIA
DROP MATERIALIZED VIEW SMSB03_0300_GT_SCH.CDR_DIA

DROP MATERIALIZED VIEW SMSB03_0300_PA_SCH.MENSAJE_DIA
DROP MATERIALIZED VIEW SMSB03_0300_PA_SCH.CDR_DIA
